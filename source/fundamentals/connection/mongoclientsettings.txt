====================
MongoClient Behavior
====================

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol


Overview
--------

In this guide, you can learn about the different settings to control
the behavior of your ``MongoClient``.

You can control the behavior of your ``MongoCleint`` by creating and passing in a 
`MongoClientSettings <{+api+}/apidocs/mongodb-driver-core/com/mongodb/MongoClientSettings.html>`__
object to the `MongoClients.create() <{+api+}/apidocs/mongodb-driver-sync/com/mongodb/client/MongoClients.html#create(com.mongodb.MongoClientSettings)>`__
method.

To create a ``MongoClientSettings`` object, use the
``MongoClientSettings.builder()`` method and chain methods to specify
your desired settings. After chaining all the settings you want, use the
``build()`` method to create the ``MongoClientSettings`` object.

.. tip:: Builder Pattern

   The builder pattern makes the settings immutable and supports 
   a simpler construction through chaining.

Example
~~~~~~~

This example demonstrates specifying a ``ConnectionString`` in a
``MongoClientSettings``:

.. literalinclude:: /includes/fundamentals/code-snippets/mcs.java
   :start-after: begin ConnectionString
   :end-before: end ConnectionString
   :language: java
   :emphasize-lines: 3
   :dedent:

.. tip::

   If you omit the ``applyConnectionString()`` method, the driver
   attempts to connect to ``localhost``.

For a list of methods available in ``MongoClientSettings``, 
see the `API Documentation <{+api+}/apidocs/mongodb-driver-core/com/mongodb/MongoClientSettings.Builder.html>`__.

The following sections describe commonly used settings:

- :ref:`Cluster Settings <mcs-cluster-settings>`
- :ref:`Socket Settings <mcs-socket-settings>`
- :ref:`Connection Pool Settings <mcs-connectionpool-settings>`
- :ref:`Server Settings <mcs-server-settings>`
- :ref:`SSL Settings <mcs-ssl-settings>`

.. _mcs-cluster-settings:

Cluster Settings
----------------

Use the `applyToClusterSettings() <{+api+}/apidocs/mongodb-driver-core/com/mongodb/MongoClientSettings.Builder.html#applyToClusterSettings(com.mongodb.Block)>`__
method to specify settings on how to connect to a MongoDB cluster. 

Example
~~~~~~~

This example specifies the following settings for connecting to a
MongoDB cluster:

- To use the settings from your ``ConnectionString``
- To connect to ``MULTIPLE`` servers in your cluster
- The server selection to take at most ``5 SECONDS``

.. literalinclude:: /includes/fundamentals/code-snippets/mcs.java
   :start-after: begin ClusterSettings
   :end-before: end ClusterSettings
   :language: java
   :emphasize-lines: 3-6
   :dedent:

For a list of methods you can use to specify your cluster settings, see
the `API Documentation <{+api+}/apidocs/mongodb-driver-core/com/mongodb/connection/ClusterSettings.Builder.html>`__.

.. _mcs-socket-settings:

Socket Settings
---------------

Use the `applyToSocketSettings() <{+api+}/apidocs/mongodb-driver-core/com/mongodb/MongoClientSettings.Builder.html#applyToSocketSettings(com.mongodb.Block)>`__
method to specify settings on how to connect to a MongoDB server.

Example
~~~~~~~

This example specifies the following settings for connecting to a
MongoDB socket:

- The connect to the socket within ``1 SECOND``
- To read from the socket within ``10 SECONDS``

.. literalinclude:: /includes/fundamentals/code-snippets/mcs.java
   :start-after: begin SocketSettings
   :end-before: end SocketSettings
   :language: java
   :emphasize-lines: 4-5
   :dedent:

For a list of methods you can use to specify your socket settings, see
the `API Documentation <{+api+}/apidocs/mongodb-driver-core/com/mongodb/connection/SocketSettings.Builder.html>`__.

.. _mcs-connectionpool-settings:

Connection Pool Settings
------------------------

Use the `applyToConnectionPoolSettings() <{+api+}/apidocs/mongodb-driver-core/com/mongodb/MongoClientSettings.Builder.html#applyToConnectionPoolSettings(com.mongodb.Block)>`__
method to specify settings related to a pool of connections to a MongoDB server.

Example
~~~~~~~

This example specifies the following settings for connecting to a
MongoDB connection pool:

- The thread to wait at most ``5 SECONDS`` for an available connection
- To have at most one connection associated with the pool
- The pooled connection to live for at most ``10c0 MILLISECONDS``

.. literalinclude:: /includes/fundamentals/code-snippets/mcs.java
   :start-after: begin ConnectionPoolSettings
   :end-before: end ConnectionPoolSettings
   :language: java
   :emphasize-lines: 4-6
   :dedent:

For a list of methods you can use to specify your connection pool
settings, see the `API Documentation <{+api+}/apidocs/mongodb-driver-core/com/mongodb/connection/ConnectionPoolSettings.Builder.html>`__.

.. _mcs-server-settings:

Server Settings
---------------

Use the `applyToServerSettings() <{+api+}/apidocs/mongodb-driver-core/com/mongodb/MongoClientSettings.Builder.html#applyToServerSettings(com.mongodb.Block)>`__
method to specify settings on how to monitor each server.

Example
~~~~~~~

This example specifies the following settings for connecting to a
MongoDB server:

- The heartbeat frequency to be at least ``10 MILLISECONDS``
- The cluster monitor to attempt reaching a server every ``3 SECONDS``

.. literalinclude:: /includes/fundamentals/code-snippets/mcs.java
   :start-after: begin ServerSettings
   :end-before: end ServerSettings
   :language: java
   :emphasize-lines: 4-5
   :dedent:

For a list of methods you can use to specify your server settings, see
the `API Documentation <{+api+}/apidocs/mongodb-driver-core/com/mongodb/connection/ServerSettings.Builder.html>`__.

.. _mcs-ssl-settings:

SSL Settings
------------

Use the `applyToSslSettings() <{+api+}/apidocs/mongodb-driver-core/com/mongodb/MongoClientSettings.Builder.html#applyToSslSettings(com.mongodb.Block)>`__
method to specify settings on how to securely connect to MongoDB using SSL.

Example
~~~~~~~

This example specifies the following settings for connecting to MongoDB
with SSL:

- To enable SSL
- To not allow invalid host names

.. literalinclude:: /includes/fundamentals/code-snippets/mcs.java
   :start-after: begin SslSettings
   :end-before: end SslSettings
   :language: java
   :emphasize-lines: 4-5
   :dedent:

.. tip::

   If you connect to localhost, you must disable SSL because there is no certificate.

For a list of methods you can use to specify your SSL settings, see the
`API Documentation <{+api+}/apidocs/mongodb-driver-core/com/mongodb/connection/SslSettings.Builder.html>`__.
